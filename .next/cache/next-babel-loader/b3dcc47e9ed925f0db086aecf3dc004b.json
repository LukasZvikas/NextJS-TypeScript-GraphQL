{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime-corejs2/regenerator\";\nimport _asyncToGenerator from \"@babel/runtime-corejs2/helpers/esm/asyncToGenerator\";\nimport _extends from \"@babel/runtime-corejs2/helpers/esm/extends\";\nimport _classCallCheck from \"@babel/runtime-corejs2/helpers/esm/classCallCheck\";\nimport _createClass from \"@babel/runtime-corejs2/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"@babel/runtime-corejs2/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime-corejs2/helpers/esm/getPrototypeOf\";\nimport _inherits from \"@babel/runtime-corejs2/helpers/esm/inherits\";\nvar _jsxFileName = \"/Users/lukas/Documents/GitHub/nextjs-graphql-typescript/components/WithAuth.tsx\";\nimport React, { Component } from 'react';\nimport { GET_USER_QUERY } from '../graphql/auth/getUser';\nimport redirect from '../lib/redirect';\nexport var withAuth = function withAuth(C) {\n  return (\n    /*#__PURE__*/\n    function (_Component) {\n      _inherits(IsAuth, _Component);\n\n      function IsAuth() {\n        _classCallCheck(this, IsAuth);\n\n        return _possibleConstructorReturn(this, _getPrototypeOf(IsAuth).apply(this, arguments));\n      }\n\n      _createClass(IsAuth, [{\n        key: \"render\",\n        value: function render() {\n          return React.createElement(C, _extends({}, this.props, {\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 20\n            },\n            __self: this\n          }));\n        }\n      }], [{\n        key: \"getInitialProps\",\n        value: function () {\n          var _getInitialProps = _asyncToGenerator(\n          /*#__PURE__*/\n          _regeneratorRuntime.mark(function _callee(context) {\n            var response;\n            return _regeneratorRuntime.wrap(function _callee$(_context) {\n              while (1) {\n                switch (_context.prev = _context.next) {\n                  case 0:\n                    _context.prev = 0;\n                    _context.next = 3;\n                    return context.apolloClient.query({\n                      query: GET_USER_QUERY\n                    });\n\n                  case 3:\n                    response = _context.sent;\n                    return _context.abrupt(\"return\", {\n                      user: response.data.getUser\n                    });\n\n                  case 7:\n                    _context.prev = 7;\n                    _context.t0 = _context[\"catch\"](0);\n                    redirect(context, '/');\n                    return _context.abrupt(\"return\", {});\n\n                  case 11:\n                  case \"end\":\n                    return _context.stop();\n                }\n              }\n            }, _callee, null, [[0, 7]]);\n          }));\n\n          function getInitialProps(_x) {\n            return _getInitialProps.apply(this, arguments);\n          }\n\n          return getInitialProps;\n        }()\n      }]);\n\n      return IsAuth;\n    }(Component)\n  );\n};","map":{"version":3,"sources":["/Users/lukas/Documents/GitHub/nextjs-graphql-typescript/components/WithAuth.tsx"],"names":["React","Component","GET_USER_QUERY","redirect","withAuth","C","props","context","apolloClient","query","response","user","data","getUser"],"mappings":";;;;;;;;;AAAA,OAAOA,KAAP,IAAgCC,SAAhC,QAAiD,OAAjD;AACA,SAASC,cAAT,QAA+B,yBAA/B;AACA,OAAOC,QAAP,MAAqB,iBAArB;AAEA,OAAO,IAAMC,QAAQ,GAAG,SAAXA,QAAW,CAAmBC,CAAnB,EAA4C;AAChE;AAAA;AAAA;AAAA;;AAAA;AAAA;;AAAA;AAAA;;AAAA;AAAA;AAAA,iCAaa;AACL,iBAAO,oBAAC,CAAD,eAAO,KAAKC,KAAZ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,aAAP;AACH;AAfL;AAAA;AAAA;AAAA;AAAA;AAAA,oDACiCC,OADjC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,2BAGmCA,OAAO,CAACC,YAAR,CAAqBC,KAArB,CAA2B;AAC9CA,sBAAAA,KAAK,EAAEP;AADuC,qBAA3B,CAHnC;;AAAA;AAGkBQ,oBAAAA,QAHlB;AAAA,qDAMmB;AAAEC,sBAAAA,IAAI,EAAED,QAAQ,CAACE,IAAT,CAAcC;AAAtB,qBANnB;;AAAA;AAAA;AAAA;AASYV,oBAAAA,QAAQ,CAACI,OAAD,EAAU,GAAV,CAAR;AATZ,qDAUmB,EAVnB;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA,MAA4BN,SAA5B;AAAA;AAiBH,CAlBM","sourcesContent":["import React, { ComponentClass, Component } from 'react';\nimport { GET_USER_QUERY } from '../graphql/auth/getUser';\nimport redirect from '../lib/redirect';\n\nexport const withAuth = <T extends object>(C: ComponentClass<T>) => {\n    return class IsAuth extends Component<T> {\n        static async getInitialProps(context: any) {\n            try {\n                const response = await context.apolloClient.query({\n                    query: GET_USER_QUERY\n                });\n                return { user: response.data.getUser }\n            }\n            catch (err) {\n                redirect(context, '/');\n                return {};\n            }\n        }\n        render() {\n            return <C {...this.props} />\n        }\n    }\n}"]},"metadata":{},"sourceType":"module"}